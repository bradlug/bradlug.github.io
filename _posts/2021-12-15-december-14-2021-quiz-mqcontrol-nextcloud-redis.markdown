---
author: John
date: 2021-12-19 21:59:36+00:00
excerpt: '<p><strong>John</strong> presented a short quiz to mark 30 years of Linux:</p><ol><li>On which teaching tool did Linus Torvalds base his original operating system?</li><li>Which is the longest continuously available Linux distribution?</li><li>Which company gave its software away and told customers they could pay for support?</li><li>What does Debian stand for?</li><li>For which processor did Linus Torvalds rewrite Linux?</li><li>Which company did Sun buy because it was cheaper than licensing Microsoft Office?</li><li>Why was the Gnome desktop created?</li><li>When was Ubuntu first issued?</li><li>Apart from the Linux kernel, what other programs has Linus Torvalds created?</li><li>Which software does Android use instead of the GNU utilities?</li><li>Which is the most widely used database software in the world?</li></ol>'
layout: post
title: 'December 14 2021 Quiz, mqcontrol, NextCloud backups, Redis'
categories:
- Past Meetings
---

<p><strong>John</strong> presented a short quiz to mark 30 years of Linux:</p><ol><li>On which teaching tool did Linus Torvalds base his original operating system?</li><li>Which is the longest continuously available Linux distribution?</li><li>Which company gave its software away and told customers they could pay for support?</li><li>What does Debian stand for?</li><li>For which processor did Linus Torvalds rewrite Linux?</li><li>Which company did Sun buy because it was cheaper than licensing Microsoft Office?</li><li>Why was the Gnome desktop created?</li><li>When was Ubuntu first issued?</li><li>Apart from the Linux kernel, what other programs has Linus Torvalds created?</li><li>Which software does Android use instead of the GNU utilities?</li><li>Which is the most widely used database software in the world?</li></ol><p><strong>Brian</strong> demonstrated <a href="https://github.com/albertnis/mqcontrol" type="text/html" role="link"><code>mqcontrol</code></a>, a command line utility to issue MQTT commands. He first installed <a href="https://go.dev/" type="text/html" role="link">Go</a> and added</p><p><code>export PATH=$PATH/usr/local/go/bin</code></p><p>to ~/.profile.</p><p>After refreshing ~/.profile with</p><p><code>source ~/.profile</code></p><p>he installed <code>mqcontrol</code> with</p><p><code>go install github.com/albertnis/mqcontrol@latest</code></p><p>and then created <code>mqcontrol.service</code> which David advised should be placed in <code>/etc/systemd/system/mqcontrol.service</code> (where it will override all others).</p><p><code>[Unit]<br>Description=mqcontrol remote control</code></p><p><code>[Service]<br>Type=simple<br>ExecStart=/home/ubuntu/work/goproj/bin/mqcontrol -i mqclinux -c "shutdown -h now" -t jf/close -h 192.168.42.90:1883</code></p><p><code>[Install]<br>WantedBy=multi-user.target<br>…</code></p><p>The IP is the MQTT broker address.</p><p>Start and enable the <code>mqcontrol</code> service</p><p><code>sudo systemctl start mqcontrol<br>sudo systemctl enable mqcontrol</code></p><p>Arguments used in the <code>mqcontrol</code> command</p><p>--help<br>-c string Command to run when any message received on topic<br>-h string Address and port of MQTT broker (default "127.0.0.1:1883")<br>-i string ID to use for this client<br>-t string Topic to subscribe to (default "computer/command")<br>-u string Username for MQTT connection<br>-p string Password for MQTT connection</p><p>See <a href="https://github.com/albertnis/mqcontrol/blob/master/README.md" type="text/html" role="link">https://github.com/albertnis/mqcontrol/blob/master/README.md</a>.</p><p>David noted that you can do simple commands in Home Assistant by editing the config file with <a href="https://yaml.org/" type="text/html" role="link">yaml</a>; this is documented in Home Assistant.</p><p><strong>Brian</strong> asked about backing up <a href="https://nextcloud.com/" type="text/html" role="link">NextCloud</a>, in particular the associated database; after a long and varied discussion of the implications of backing up a database, depending on the type of database, David suggested that best thing was to wait till nothing was happening and then copy the NextCloud directory. John pointed out that, if the database is <code>mysql/mariadb</code>, you can use <a href="https://mariadb.com/kb/en/making-backups-with-mysqldump/" type="text/html" role="link"><code>mysqldump</code></a> to back the databases up to the NextCloud directory and then back that up.</p><p>Brian said that he had wanted to configure <a href="https://www.opera.com/" type="text/html" role="link">Opera</a> Android like Opera Desktop so that it was not rejected by a website; David commented that there are lots of results in Google about changing the user agent in Opera but none of them work and Brian said that he had had no response to his query on the Opera forums. However, we noted this <a href="https://addons.opera.com/en-gb/extensions/details/user-agent-switcher-5/" type="text/html" role="link">discussion</a>.</p><p>There followed an extended discussion between David and Brian on Home Assistant configuration, including how to set up the correct permissions for the device which is monitoring your location on behalf of Home Assistant.</p><p>David showed off the servos he had ordered which had arrived but which he could not use because the <a href="https://www.aliexpress.com/item/32466332558.html?spm=a2g0o.productlist.0.0.63922fd3w3u8Vv&algo_pvid=bb735d55-4ff1-42cb-90e2-8d5e63705621&algo_exp_id=bb735d55-4ff1-42cb-90e2-8d5e63705621-0&pdp_ext_f=%7B%22sku_id%22%3A%2210000000511473332%22%7D" type="text/html" role="link">PCA9685 server board</a> had not and also a 3½" disc drive holding dBASE III!</p><p><strong>Darren</strong> had found that the OU expectations of the Jupyter notebooks exercise had been higher than he had expected; the programming assignment had been to write a program to recognise images. The next unit looks at <a href="https://www.ibm.com/topics/convolutional-neural-networks" type="text/html" role="link">convolutional neural networks</a> and whether there are alternatives to using them.</p><p>For his final year project he is thinking of developing a command line project.</p><p>He mentioned that he had read somewhere that <a href="https://www.microfocus.com/en-us/what-is/cobol" type="text/html" role="link">Cobol</a> was supposed to be easy but John explained that that was in comparison with <a href="https://fortran-lang.org/" type="text/html" role="link">Fortran</a> and assembler. There is now a major project to support Cobol on Linux because so many mainframe based systems still use it and David showed off his Cobol book.</p><p><strong>Bernard</strong> shared a feature of using <a href="https://redis.io/" type="text/html" role="link">Redis</a> (which he had described at the <a href="http://bradlug.co.uk/blog/2017/10/20/october-09-2017-mqtt-modx-civicrm-meet" type="text/html" role="link">9 October 2017 meeting</a>) whereby someone can subscribe to a key value in order to receive data so that it becomes a subscription service.</p><img src="http://www.bradlug.co.uk/blog/2021/12/14/images/Redis_1.png" width = "399" height="598" alt="Three processes accessing a store" role="img"><p>If a publisher writes a log file, for example, to an append only channel, you end up with a continuous stream.</p><img src="http://www.bradlug.co.uk/blog/2021/12/14/images/Redis_2.png" width = "399" height="598" alt="A publisher writing to a store and three processes reading from it" role="img"><p>You can also write a program to use the last 20 readings, for example, to create a histogram so that you end up with an average:</p><pre># Continuously read a block of 20, print averages of last 20 temperature, humidity.
# suitable for an histogram
import redis, pprint	rconn = redis.Redis(host='localhost', port=6379, db=0)
lastid = "0-0"
while True:
    # read a block of 20, waiting 500 msec if no readings present
    test = rconn.xread({"mystream": lastid}, count=20, block=500)
    # test is list of lists of tuples, [[ b'mystream', [(id, valuedict),...]],...]
    streamresult = test[0][1]
    if not streamresult:
        # no readings, so continue with the while loop again
        continue
    while len(streamresult) <20:
        # not 20 readings yet, waiting for further readings, read one more
        lastid = streamresult[-1][0]
        test = rconn.xread({"mystream": lastid}, count=1, block=500)
        nextresult = test[0][1]
        if not nextresult:
            continue
        # so another reading taken, add it to streamresult
        streamresult.extend(nextresult)
    # streamresult now contains 20 readings, get last id for the next 20
    lastid = streamresult[-1][0]
    average_temperature_in_block = sum(float(item[1][b"temperature"].decode("utf-8")) for item in streamresult) / 20
    average_humidity_in_block = sum(float(item[1][b"humidity"].decode("utf-8")) for item in streamresult) / 20
    print(round(average_temperature_in_block,2), round(average_humidity_in_block,2))</pre><img src="http://www.bradlug.co.uk/blog/2021/12/14/images/Redis_3.png" width = "399" height="598" alt="A publisher writing a log file, for example" role="img"><p>You can extend this by creating consumer groups which receive unique input, allowing data to be split across different tasks and for another process to take up a task if one fails.</p><img src="http://www.bradlug.co.uk/blog/2021/12/14/images/Redis_4.png" width = "399" height="598" alt="Three consumer processes taking unique data from a store supplied by a publisher" role="img"><p>He also mentioned that, when he installed Linux Mint, his Samba share didn't work because the latest version of <a href="https://www.samba.org/" type="text/html" role="link">Samba</a> stops the older version of the protocol from working for security reasons.</p><p>So edited <code>/etc/samba/smb.conf</code> to add the lines:</p><p><code>## added by bernie<br>client min protocol = NT1</code></p><p>because his BT router uses it.</p><p>He noted that <a href="https://en.wikipedia.org/wiki/Snap_(package_manager)" type="text/html" role="link">Snaps</a> are disabled in Linux Mint for the reasons set out in <a href="https://blog.linuxmint.com/?p=3766" type="text/html" role="link">this blog</a>.</p><p><strong>Brian</strong> commented that he uses CIFS to do same as Samba with</p><p><code>### //server/Downloads<br>/home/brian/Downloads cifs credentials=/root/.smbcredentials,iocharset=utf8,file_mode=0777,_netdev,dir_mode=0777 0 0</code></p><p><strong>John</strong> shared the page in the <a href="https://www.linux.com/featured/download-the-2021-linux-foundation-annual-report/" type="text/html" role="link">Linux Foundation Annual Report</a> showing that Linux kernel support only accounted for 3.4% of expenditure while over 50% went on project support, illustrating the magnitude of the changes over the past 30 years.</p><img src="http://www.bradlug.co.uk/blog/2021/12/14/images/LF_finances.png" width = "400" height="400" alt="Page showing revenue and expenditure for 2021" role="img"><p>David commented that that was 3.4% of a very large turnover.</p><h3>Answers to the quiz</h3><ol><li>Minix</li><li>Slackware — first issued 17 July 1993</li><li>Intel — they referred customers to Michael Tiemann who set up Cygnus Support — later RedHat</li><li>Deborah and Ian Murdoch</li><li>DEC Alpha — in the process he made it possible to support any architecture, not just Intel chips</li><li>StarOffice — which later became OpenOffice from which LibreOffice was forked</li><li>Because the KDE desktop used the non-free Qt toolkit at the time</li><li>20 October 2004 — Warty Warthog</li><li>Git and Subsurface — a scuba-diving program</li><li>Java initially implemented via the Dalvik VM and now by Android Runtime</li><li>SQLite — because it is used in Android smartphones, it displaced <code>mysql/mariadb</code> from the top spot.</li>
