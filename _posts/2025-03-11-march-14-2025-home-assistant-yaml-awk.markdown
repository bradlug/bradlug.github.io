---
author: John
date: 2025-03-14 21:59:36+00:00
excerpt: '<p><strong>Brian</strong> described how he had tackled a problem when parcels are delivered; he normally only gets advice of the delivery shortly before it happens and he may be too far away from home to return in time for the delivery.</p><p><a href="https://www.home-assistant.io/" type="text/html" role="link">Home Assistant</a> manages the door control which sends a tremolo which is AC and has to be converted to DC. He can set this signal so that it will automatically open the door. The ESP8266 manages the relays which require 5 volts; however, the ESP8266 has no 5 volt output, only 3.3 volt pinouts. So he takes 5 volts from the lead to power the relays.</p>'
layout: post
title: 'March 11 2025 Home Assistant, yaml, AWK'
categories:
- Past Meetings
---
<p><strong>Brian</strong> described how he had tackled a problem when parcels are delivered; he normally only gets advice of the delivery shortly before it happens and he may be too far away from home to return in time for the delivery.</p><p><a href="https://www.home-assistant.io/" type="text/html" role="link">Home Assistant</a> manages the door control which sends a tremolo which is AC and has to be converted to DC. He can set this signal so that it will automatically open the door. The ESP8266 manages the relays which require 5 volts; however, the ESP8266 has no 5 volt output, only 3.3 volt pinouts. So he takes 5 volts from the lead to power the relays.</p><p>Note that the <a href="https://www.wemos.cc/en/latest/d1/d1_mini.html" type="text/html" role="link">D1 mini</a> has 5 volt output — so he also uses these — while the <a href="https://en.wikipedia.org/wiki/ESP32" type="text/html" role="link">ESP32</a> has bluetooth and can pick up the readings from sensors.</p><p>With Home Assistant you can program things in <a href="https://yaml.org/" type="text/html" role="link"><code>yaml</code></a> and <a href="https://esphome.io/" type="text/html" role="link">ESPHome</a> tells you what to put in the <code>yaml</code> file; you have to indent like Python. He has programmed it to turn on the relay for four seconds; this takes the lock off the door for four seconds so that someone can push the gate and come in.</p><p>Steve raised security concerns about this arrangement and Brian said that it is controlled by whether his mobile is receiving wi-fi or not. If he is out, his mobile is not receiving wi-fi and so the script runs to release the lock; if his mobile is receiving wi-fi, he is at home and the script does not run. Steve wondered whether it was limited to one occurrence and Brian said that was a good idea; he could implement that by putting a sensor in the parcel box so that, when the parcel was delivered, the system would switch off.</p><p>Brian noted that Home Assistant can validate your <code>yaml</code> but it doesn’t tell you what is wrong. However <a href="https://codedocs.org/what-is/lint-software" type="text/html" role="link">lint</a> will check your <code>yaml</code> though sometimes it says line 1 is wrong when it isn’t.</p><p>Darren asked about automation and Brian said that, in Home Assistant, you can create automations by selecting a device or its entities. If you examine a device, Home Assistant tells you what entities it has. You can then automate by giving an entity a state which is a trigger which may be linked to other conditions to activate the action. You have to create one automation to switch something on and one to switch it off.</p><p>Steve asked about presence detection via a mobile and Brian explained that the <a href="https://companion.home-assistant.io/" type="text/html" role="link">Home Assistant Companion</a> app is available on a mobile ’phone but not on a laptop. It polls the server and Steve wondered what impact that would have on the battery. Brian said that it was not much though David said that Home Assistant Companion used twice as much as another similar app.</p><p><strong>Steve</strong> mentioned that he has a device to plug an ESP8266 into a USB. He has a Tuya module pin-compatible with ESP and uses the <a href="https://www.superhouse.tv/37-installing-tasmota-using-tasmotizer/" type="text/html" role="link">Tasmotizer</a> to program it.</p><p><strong>Darren</strong> was going to give a presentation on <a href="https://en.wikipedia.org/wiki/AWK" type="text/html" role="link">AWK</a>, the data extraction program, but his browser, <a href="https://www.falkon.org/" type="text/html" role="link">Falkon</a>, did not support screen sharing. The following <a href="http://www.bradlug.co.uk/blog/2025/03/11/files/Welcome_to_AWK.pdf" type="application/pdf" role="link">presentation</a> is what he was going to say. The example files are <a href="http://www.bradlug.co.uk/blog/2025/03/11/files/cat_in_awk.awk" type="application/x_awk" role="link">cat_in_awk.awk</a>, <a href="/home/john/Computing/LUGs/Bradford_GNULUG/AWK_files/cat_slow.awk" type="application/x_awk" role="link">cat_slow.awk</a>, <a href="http://www.bradlug.co.uk/blog/2025/03/11/files/sort.awk" type="application/x_awk" role="link">sort.awk</a>, <a href="http://www.bradlug.co.uk/blog/2025/03/11/files/sum_categories.awk" type="application/x_awk" role="link">sum_categories.awk</a> and <a href="http://www.bradlug.co.uk/blog/2025/03/11/files/sum_input.awk" type="application/x_awk" role="link">sum_input.awk</a>.</p><p><strong>David</strong> reported that he had got part way through soldering up <a href="https://www.klipper3d.org/Measuring_Resonances.html" type="text/html" role="link">Klipper</a> but had used the wrong sort of wire; so he has made no progress since last month. He also reported that he had added a SATA card to his desktop but the sticky pad behind the heat sink had dried out and so it was not sinking the heat and the SATA channel was not working properly.</p><p>He also mentioned that, in Home Assistant, the sliders are not calibrated for the dimness/brightness to devices; everything happens in the middle of the scale. Brian suggested that you can specify a maximum value for a slider; he also noted that in the recent release the overview had changed. He also noted that you can do <a href="https://nodered.org/" type="text/html" role="link">Node_RED</a> in Home Assistant because it knows all the entities.</p><p><strong>Steve</strong> said he was using it to check the TV and turn the amplifier off when the TV is off because the amplifier uses a lot of electricity. Brian said that he had set Home Assistant to know when the TV is on and then turn the amplifier on.</p>
